# 同济资助政策对接解读网站（MVP：安徽）— CLAUDE.md

> 这个文件是本仓库的“项目统领说明”。在 Claude Code / VS Code 中工作时，请默认遵循这里的规则。
> 本项目以“内容严谨、证据链透明、可扩省”为第一优先级。

---

## 0. 一句话目标

做一个把「安徽（生源地）资助政策」与「同济大学校内资助体系」对接起来的网站：用**时间轴 + 项目卡**告诉用户“能办什么、何时办、去哪办、到同济怎么对接”，并能生成**行动清单**。

---

## 1. 最高优先级：单一可信源（SSoT）

本项目的“需求与规范”不在你脑补，也不在你重写的文字里，而在以下三份文档里（它们是唯一真值）：

- `01_单一信源_IA_v2.txt`（信息架构与导航 IA）
- `02_单一信源_Schema_v2.txt`（内容与数据规范 Schema：字段、受控词表、发布流程）
- `03_单一信源_TemplateSpec_v2.txt`（页面模板与组件规范）

**强制规则：**

1) 不得另起炉灶新增核心路由、字段命名、受控词表或页面结构。  
2) 若三份文档内部出现冲突：  
   - 字段名 / 受控词表 / 数据校验：以 **Schema** 为最高优先级  
   - 路由与页面结构：以 **IA + TemplateSpec 的一致部分**为准（两者应一致）  
3) 你可以补充“工程实现细节”（文件组织、组件拆分、脚本实现方式），但不得改变规范。

---

## 2. 数据真值与发布流水线（必须遵守）

本项目采用“编辑端 Excel + 发布端 JSON”的工作流：

- **编辑端（人工录入真值）**：`data/*.xlsx`
- **发布端（网站运行真值）**：`src/data/*.json`
- **转换脚本**：`scripts/excel_to_json.py`（或同名脚本）
- **校验脚本**：`scripts/validate_data.py`（或同名脚本）

**发布流水线固定为：**

1) 修改 Excel（`data/*.xlsx`）
2) 运行导出：Excel → JSON
3) 运行校验：validate（必填字段、ID 唯一、受控词表、evidence>=1 等）
4) 校验通过后才允许提交代码/部署

> 重要：网站页面只读取 `src/data/*.json`。不要在页面里写死政策内容，更不要“抓取线上实时数据”。

---

## 3. 严谨性与合规显示（硬性底线）

1) **不得编造政策事实**（金额、时间窗口、对象、办理步骤、入口链接、材料等都不能凭空补齐）。  
2) 每张 PolicyCard 必须有 `evidence_list` 且 **至少 1 条证据**。  
3) 任何“数字/对象/窗口期”等关键信息必须可回链到 evidence。  
   - 如果无法回链：将 `status` 标为 `needs_review`，并在页面显著提示“需复核”。  
4) 避免大段复制官网：若需要摘录，仅可做“最小必要摘录”（短句/关键条款片段），并链接回原文。  
5) 页面必须展示“核验日期（verified_date）”与免责声明：  
   - “以官方发布为准；本站提供对接式解读与路径建议；所有条款请以来源链接核验”。

---

## 4. 必须实现的路由（以 IA + TemplateSpec 为准）

MVP（安徽）至少包括：

- `/` 首页  
- `/provinces` 省份选择（MVP 仅安徽，但结构支持扩省）  
- `/p/anhui` 安徽专区（时间轴四段 + 筛选 + 卡片列表 + 行动清单入口）  
- `/policies` 项目库（检索/过滤/排序）  
- `/policy/{card_id}` 项目详情（四层结构：要点/申请/同济对接/证据）  
- `/_/plan` 行动清单（支持 ids 参数；按四段时间轴输出；MVP 支持复制文本）  
- `/faq` FAQ  
- `/glossary` 术语解释  
- `/sources` 来源与声明（分组展示 SourceSite）  
- `/changelog` 更新日志（链接到相关卡片）  
- `/feedback` 反馈纠错（静态表单 + mailto/第三方表单即可）

**关键规则：**

- 安徽专区页的“最后核验日期”：必须按规范计算为  
  **当前展示的所有卡片中 evidence_list[].verified_date 的最大值**。

---

## 5. 工作方式（强制：先计划后改动）

每次接到任务，请按以下流程执行：

1) **先读取文件再回答**  
   - 必读：三份 SSoT 文档 + 相关 `src/data/*.json` + `scripts/validate_*`  
2) **先输出 PLAN（计划）**  
   - 给出：要改哪些文件、为什么、实现步骤、可能的风险点  
3) 用户确认后再写代码（或按用户要求直接写，但仍需保持改动最小）  
4) 写完后给出：如何运行、如何校验、预期页面变化点

**禁止：**

- 不要大规模重构（除非明确要求）
- 不要擅自换技术栈（除非说明理由且得到确认）
- 不要把数据从 JSON 搬到组件常量里

---

## 6. 技术栈建议（可调整但需说明理由）

推荐：

- Astro + TypeScript（静态输出）
- Tailwind CSS（或原生 CSS）
- 交互：React islands（筛选、行动清单生成）
- 部署：Vercel / Netlify / Cloudflare Pages / GitHub Pages（任一）

> 若你选择不同技术栈，必须解释“为什么更符合静态、可扩省、可审查”。

---

## 7. 常用命令（仓库约定）

（按实际 package.json 替换）

- `npm run dev` 本地开发
- `npm run build` 构建静态站
- `npm run validate` 数据校验（必须能返回非 0 错误码）

---

## 8. 扩省与增卡（面向未来）

### 新增省份

- 只应新增/修改 `src/data/provinces.json`（以及新增该省的 policycards 与 sourcesites）
- 不应改动核心组件逻辑（除非原设计无法支持）

### 新增项目卡（PolicyCard）

- 只改数据（Excel 或 JSON），并确保：
  - 字段齐全、受控词表合法、evidence>=1、status 合理
- 若信息不完整：不要硬写具体数值，用 `needs_review` 标记并写明“待补齐/建议咨询入口”。

---

## 9. 你需要特别注意的三件事（避免跑偏）

1) 网站价值不是“搬运政策原文”，而是“地区—同济对接”与“行动清单”。  
2) Schema 字段名与受控词表是硬约束，不能随意改名。  
3) 永远让“证据链”可追溯、可核验、可更新。

---
