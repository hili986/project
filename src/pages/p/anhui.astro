---
import BaseLayout from '../../layouts/BaseLayout.astro';
import DisclaimerFooter from '../../components/DisclaimerFooter.astro';
import AnhuiHub from '../../components/AnhuiHub';
import { getCardsByProvince } from '../../utils/data';
import type { Stage } from '../../types';

const cards = getCardsByProvince('anhui');

/* read optional URL params for pre-filtering from homepage */
const stageParam = Astro.url.searchParams.get('stage') ?? '';
const validStages: Stage[] = ['pre_admission', 'enrollment_day', 'after_enrollment', 'graduation'];
const initialIdentity = validStages.includes(stageParam as Stage) ? stageParam : '';
---

<BaseLayout title="安徽专区">
  {/* page header */}
  <div class="space-y-2 mb-6">
    <h1 class="text-2xl font-bold">安徽专区</h1>
    <p class="text-gray-600">
      安徽生源地资助政策与同济大学校内资助体系的对接导航。按时间轴浏览，筛选你关心的项目。
    </p>
    <div class="flex flex-wrap gap-3 text-sm">
      <a
        href="https://student.tongji.edu.cn/xszz.htm"
        target="_blank"
        rel="noopener noreferrer"
        class="text-blue-700 hover:underline"
      >
        同济大学学生资助中心
      </a>
      <a
        href="https://www.cdb.com.cn"
        target="_blank"
        rel="noopener noreferrer"
        class="text-blue-700 hover:underline"
      >
        国家开发银行助学贷款
      </a>
    </div>
  </div>

  {/* core interactive area (React island) */}
  <AnhuiHub
    client:load
    cards={cards}
    initialFilters={initialIdentity ? { identity: initialIdentity } : {}}
  />

  {/* risk disclaimer */}
  <DisclaimerFooter />
</BaseLayout>
